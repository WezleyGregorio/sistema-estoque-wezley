{% extends "layout.html" %}

{% block content %}
<div class="header">
    <h1 class="page-title">Bem-vindo, {{ session.get('login_atual') }}</h1>
    <button class="btn btn-primary">
        <i class="ri-refresh-line"></i> Atualizar
    </button>
</div>

<div class="cards-grid">
    <div class="card">
        <div class="card-label">Faturamento Hoje</div>
        <div class="card-value val-blue">R$ {{ "%.2f"|format(total_faturado) }}</div>
    </div>
    <div class="card">
        <div class="card-label">Vendas Realizadas</div>
        <div class="card-value val-pink">{{ total_vendas_qtd }}</div>
    </div>
    <div class="card">
        <div class="card-label">Total Produtos</div>
        <div class="card-value val-green">{{ total_produtos_cadastrados }}</div>
    </div>
    <div class="card">
        <div class="card-label">Itens em Estoque</div>
        <div class="card-value">{{ total_unidades_estoque }}</div>
    </div>
</div>

<div class="table-container">
    <div class="table-header-area">
        <h3 style="margin:0; color:white;">Vendas Recentes</h3>
        <div>
            <a href="/baixar_relatorio" class="btn" style="border: 1px solid #333; color: #ccc;">Baixar Relatório</a>
            <a href="/limpar_caixa" class="btn btn-danger" onclick="return confirm('Zerar o caixa?')">Zerar Caixa</a>
        </div>
    </div>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Horário</th>
                <th>Produto</th>
                <th>Valor</th>
            </tr>
        </thead>
        <tbody>
            {% for venda in historico %}
            <tr>
                <td>#{{ venda[0] }}</td>
                <td>{{ venda[2][11:16] }} <small style="color:#666">{{ venda[2][8:10] }}/{{ venda[2][5:7] }}</small></td>
                <td style="font-weight:500; color:white;">{{ venda[1] }}</td>
                <td style="color: var(--neon-green);">+ R$ {{ "%.2f"|format(venda[3]) }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="4" style="text-align: center; padding: 40px; color: #666;">
                    Nenhuma venda registrada hoje.
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}